<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="description" content="Ứng dụng luyện tập đàn piano với các bài tập ngẫu nhiên" />
    <meta name="theme-color" content="#4a90e2" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="AllKeyTrainor" />
    <title>All Key Trainer</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="./piano_icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="./piano_icon.png">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="app">
        <div class="top-bar">
            <div class="tone-select">
                <label for="tone">Tone</label>
                <select v-model="currentKey" @change="createNewExercise">
                    <option v-for="t in tones" :key="t" :value="t">
                        {{ t }}
                    </option>
                </select>
            </div>
            <div class="note-count">
                <span><label for="noteNum">Số note</label></span>

                <button @click="changeNoteCount(-1)" :disabled="noteCount <= 2">−</button>
                <span class="count">{{ noteCount }}</span>
                <button @click="changeNoteCount(1)" :disabled="noteCount >= 10">+</button>
            </div>
            <div class="controls">
                <button class="btn btn-secondary" @click="resetExercise">Refresh</button>
                <button class="btn btn-primary" @click="createNewExercise">Next</button>
            </div>
        </div>

        <div class="exercise">
            <span v-for="n in exerciseNotes" :class="['ex-note', n.status]">
                {{ n.label }}
            </span>
        </div>


        <div class="piano">
            <template v-for="key in keys">
                <!-- White key -->
                <div v-if="!key.isBlack" class="white-key" :class="{ 'key-pressed': key.isPressed }"
                    @touchstart.prevent="handleTouchStart(key, $event)" @touchend.prevent="handleTouchEnd(key, $event)"
                    @touchcancel.prevent="handleTouchEnd(key, $event)" @mousedown.prevent="handleMouseDown(key, $event)"
                    @mouseup.prevent="handleMouseUp(key, $event)" @mouseleave="handleTouchEnd(key, $event)">
                    <!-- <div class="label">{{ key.note }}</div> -->
                </div>

                <!-- Black key -->
                <div v-else class="black-key" :class="{ 'key-pressed': key.isPressed }"
                    :style="{ left: key.left + 'px' }" @touchstart.prevent="handleTouchStart(key, $event)"
                    @touchend.prevent="handleTouchEnd(key, $event)" @touchcancel.prevent="handleTouchEnd(key, $event)"
                    @mousedown.prevent="handleMouseDown(key, $event)" @mouseup.prevent="handleMouseUp(key, $event)"
                    @mouseleave="handleTouchEnd(key, $event)"></div>
            </template>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>